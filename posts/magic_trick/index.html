<!doctype html><html><meta charset=utf-8><meta name=generator content="Hugo 0.119.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>SHCTF23: Magic Trick&nbsp;&ndash;&nbsp;The Mess Of Nebula</title><link rel=stylesheet href=/css/core.min.3dff9636f60da21a7bce297e09d08d8f636d1b8e7def5079c790207b0c0dfdc945858b105a0c7fc6c4a0b4f9ae05e8d3.css integrity=sha384-Pf+WNvYNohp7zil+CdCNj2NtG45971B5x5AgewwN/clFhYsQWgx/xsSgtPmuBejT><body><div class="base-body max-width"><section id=header class="header max-body-width"><div class=header-wrap><div class=header-left-side><a class=home href=/><span class=site-name>The Mess Of Nebula</span><span class=site-slogan>Gravitations towards point origin</span></a></div><div class=header-right-side><div class=nav-wrap><div class=nav><a class=site-tag href=/categories/>Categories</a><a class=site-tag href=/tags/>Tags</a><a class=site-tag href=/about>About</a></div></div></div></div></section><div id=content class="flex-body max-body-width"><section class=article-header><h1>SHCTF23: Magic Trick</h1><p class=article-date>2023-09-26</p></section><article class=markdown-body><p><strong>Description: Sometimes, what&rsquo;s white is merely a canvas awaiting its story. Recall the artist&rsquo;s technique from the age of angels, and you might unveil a tale hidden in code.</strong></p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/canvas.png><img class=img src=/images/magic/canvas.png alt=canvas.png></a></p><hr><p>This was a fun puzzle! üòÉ</p><p>You are given a executable file and a blank white <code>png</code> file.</p><h2 id=binary-analysis>Binary analysis</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>‚îî‚îÄ$ file magic                     
</span></span><span class=line><span class=cl>magic: ELF 64-bit LSB executable, x86-64, version <span class=m>1</span> <span class=o>(</span>SYSV<span class=o>)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID<span class=o>[</span>sha1<span class=o>]=</span>3dfe013b3027047470d1aac10a3504baf6969725, <span class=k>for</span> GNU/Linux 2.6.32, stripped
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>objdump -sj .rodata magic
</span></span></code></pre></div><p><a target=_blank rel="noopener noreferrer" href=/images/magic/00.png><img class=img src=/images/magic/00.png alt=Untitled></a></p><p>You quickly find out that this is a python executable packed using PyInstaller. You need to unpack the binary.</p><p>To unpack, use <a href=https://github.com/extremecoders-re/pyinstxtractor target=_blank>Pyinstxtractor</a>.</p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/1.png><img class=img src=/images/magic/1.png alt=Untitled></a></p><hr><p>From the extracted files, a few things stand out that are worth checking:</p><ol><li>The <a href=https://pycryptodome.readthedocs.io/en/latest/src/installation.html target=_blank>Cryptodome</a> package leaves a stinky trail of encryption soon to be encountered.</li><li>The <code>magic.pyc</code> is almost likely the entry-point to this challenge.</li></ol><p><a target=_blank rel="noopener noreferrer" href=/images/magic/2.png><img class=img src=/images/magic/2.png alt=Untitled></a></p><p>You need to disassemble the <code>magic.pyc</code> bytecode and attempt to make sense of it.</p><h2 id=pyc-disassembly>Pyc disassembly</h2><blockquote><p>üí° Learn about the <code>.pyc</code> structure and bytecode:</p><p><a href=http://benno.id.au/blog/2013/01/15/python-determinism target=_blank>http://benno.id.au/blog/2013/01/15/python-determinism</a></p><p><a href=https://nowave.it/python-bytecode-analysis-1.html target=_blank>https://nowave.it/python-bytecode-analysis-1.html</a></p><p><a href=https://unpyc.sourceforge.net/Opcodes.html target=_blank>Python Opcodes</a></p><p><a href=https://github.com/python/cpython/blob/main/Python/ceval.c target=_blank>https://github.com/python/cpython/blob/main/Python/ceval.c</a></p><p><a href=https://github.com/python/cpython/blob/main/Lib/opcode.py target=_blank>https://github.com/python/cpython/blob/main/Lib/opcode.py</a></p></blockquote><p>You use the <code>dis</code> package to disassemble the <code>.pyc</code> file</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>import dis
</span></span><span class=line><span class=cl>import marshal
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Path to the .pyc file</span>
</span></span><span class=line><span class=cl><span class=nv>pyc_path</span> <span class=o>=</span> <span class=s2>&#34;magic.pyc&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Open the .pyc file in binary read mode</span>
</span></span><span class=line><span class=cl>with open<span class=o>(</span>pyc_path, <span class=s2>&#34;rb&#34;</span><span class=o>)</span> as f:
</span></span><span class=line><span class=cl>    <span class=c1># Skip the first 16 bytes (magic number and timestamp, file size)</span>
</span></span><span class=line><span class=cl>    f.read<span class=o>(</span>16<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Read the rest of the file, which contains the marshalled code object</span>
</span></span><span class=line><span class=cl>    <span class=nv>code_obj</span> <span class=o>=</span> marshal.load<span class=o>(</span>f<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Disassemble the code object</span>
</span></span><span class=line><span class=cl>dis.dis<span class=o>(</span>code_obj
</span></span></code></pre></div><h2 id=function-analysis>Function Analysis</h2><p>(An LM might help you half the way üôÇ)</p><p>Looking at the <a href=#deconstructed-bytecode>bytecode</a> you notice the three main functions:</p><p>(What‚Äôs up with a <code>pdf</code> and a <code>png</code> ü§î)</p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/3.png><img class=img src=/images/magic/3.png alt=Untitled></a></p><h3 id=derive_key>derive_key()</h3><p>This function seems to xor every byte of the const <code>[rh&lt;c8^ey?}ng:el</code> with <code>11</code></p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/4.png><img class=img src=/images/magic/4.png alt=Untitled></a></p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/5.png><img class=img src=/images/magic/5.png alt=Untitled></a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>key</span> <span class=o>=</span> <span class=s1>&#39;[rh&lt;c8^ey?}ng:el&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>xored_string</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> i in range<span class=o>(</span>len<span class=o>(</span>key<span class=o>))</span>:
</span></span><span class=line><span class=cl>    <span class=nv>xored_string</span> <span class=o>+=</span> chr<span class=o>(</span>ord<span class=o>(</span>key<span class=o>[</span>i<span class=o>])</span> ^ 11<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print<span class=o>(</span>xored_string<span class=o>)</span> <span class=c1># Pyc7h3Unr4vel1ng</span>
</span></span></code></pre></div><p>Just like that, a key üòé</p><h3 id=embed_and_extractsourcepdf-targetpng>embed_and_extract(source.pdf, target.png)</h3><p>This is a relatively long function, and it is always fun to deconstruct in pictures üéë:</p><ol><li><p>Call <code>derive_key</code> .Key ‚Üí <code>Pyc7h3Unr4vel1ng</code></p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/6.png><img class=img src=/images/magic/6.png alt=Untitled></a></p></li><li><p><code>read_file_content</code> of a <code>source.pdf</code> and a <code>target.png</code></p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/7.png><img class=img src=/images/magic/7.png alt=Untitled></a></p></li><li><p>‚Ä¶ Construct a png header and decrypting it.</p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/8.png><img class=img src=/images/magic/8.png alt=Untitled></a></p></li><li><p>Construct the <code>iv</code> by xor the <code>decrypted_header</code> and the <code>pdf_prefix</code></p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/9.png><img class=img src=/images/magic/9.png alt=Untitled></a></p></li><li><p>Encrypt a pdf, with the key and the iv</p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/10.png><img class=img src=/images/magic/10.png alt=Untitled></a></p></li></ol><p>Hold up.. hold up! Pump up the breaks here You need to wrap around this and get the <code>iv</code> . If there‚Äôs any decryption to be done, you need a <code>key</code> and an <code>iv</code> . Def!</p><blockquote><p>What is known:</p><ul><li>The <code>iv</code> is generated by xor‚Äôing the <code>pdf‚Äôs 16 bytes</code> with a <code>decrypted png header</code>.</li><li>The PDF‚Äôs prefix is known(globally defined in the program).</li><li>The <code>decrypted png header</code> is <code>ECB.decrypt(PNG_header, key)</code></li><li>The <code>key is known</code> .</li><li>The <code>PNG_header</code> = <code>PNG_signature</code> ‚úÖ + <code>(len(pdf) - BLOCK_SIZE)</code> ‚ùå + <code>PNG_CHUNK_TYPE</code> ‚úÖ</li><li><ul><li>You have a PNG file ü§î.
Knowing what you know and knowing CBC, the encryption of the PDF in step 5 will result in a PNG header in the first 16 bytes!</li></ul></li></ul></blockquote><p>Canvas on ghex‚Ä¶ Get that PNG header!</p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/11.png><img class=img src=/images/magic/11.png alt=Untitled></a></p><p>All in for the <code>iv</code>!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=err>#</span> <span class=mi>56</span> <span class=nx>LOAD_CONST</span>               <span class=mi>8</span> <span class=p>(</span><span class=nx>b</span><span class=s1>&#39;%PDF-1.4\n%\xd3\xeb\xe9\xe1\n1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=err>#</span> <span class=mi>58</span> <span class=nx>STORE_NAME</span>              <span class=mi>10</span> <span class=p>(</span><span class=nx>PDF_PREFIX_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>from</span> <span class=nx>Cryptodome</span><span class=p>.</span><span class=nx>Cipher</span> <span class=kr>import</span> <span class=nx>AES</span>
</span></span><span class=line><span class=cl><span class=nx>key</span> <span class=o>=</span> <span class=nx>b</span><span class=s2>&#34;Pyc7h3Unr4vel1ng&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>canvas_header</span> <span class=o>=</span> <span class=nx>b</span><span class=s1>&#39;\x89\x50\x4e\x47\x0d\x0a\x1a\x0a\x00\x00\x75\xc0\x61\x61\x61\x61&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>pdf_prefix</span> <span class=o>=</span> <span class=nx>b</span><span class=s1>&#39;%PDF-1.4\n%\xd3\xeb\xe9\xe1\n1&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>decrypted_header</span> <span class=o>=</span> <span class=nx>AES</span><span class=p>.</span><span class=k>new</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>AES</span><span class=p>.</span><span class=nx>MODE_ECB</span><span class=p>).</span><span class=nx>decrypt</span><span class=p>(</span><span class=nx>canvas_header</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>iv</span> <span class=o>=</span> <span class=nx>bytes</span><span class=p>([</span><span class=nx>decrypted_header</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>^</span> <span class=nx>pdf_prefix</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=k>for</span> <span class=nx>i</span> <span class=k>in</span> <span class=nx>range</span><span class=p>(</span><span class=mi>16</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>print</span><span class=p>(</span><span class=nx>iv</span><span class=p>)</span> <span class=err>#</span> <span class=nx>b</span><span class=s1>&#39;\x14mwJ\x90[\x8ar:\xe1\xccY\xbc\xb5\x8b\xa1&#39;</span>
</span></span></code></pre></div><ol><li><p>The <code>encrypted_pdf</code>(16 bytes of this is a png_header) is appended with the <code>png_content[8:]</code>. This is decrypted and then stored into <code>out.pdf</code></p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/12.png><img class=img src=/images/magic/12.png alt=Untitled></a></p></li></ol><h2 id=for-all-the-marbles>For All The Marbles!</h2><p><strong>Trick question: What do you get when you encrypt a PDF?‚Ä¶ A png!</strong></p><p>With the <code>key</code> and the <code>iv</code> , go ahead and decrypt the <code>canvas.png</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>from</span> <span class=nx>Cryptodome</span><span class=p>.</span><span class=nx>Cipher</span> <span class=kr>import</span> <span class=nx>AES</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>algo</span> <span class=o>=</span> <span class=nx>AES</span><span class=p>.</span><span class=k>new</span><span class=p>(</span><span class=nx>b</span><span class=s1>&#39;Pyc7h3Unr4vel1ng&#39;</span><span class=p>,</span> <span class=nx>AES</span><span class=p>.</span><span class=nx>MODE_CBC</span><span class=p>,</span> <span class=nx>b</span><span class=s1>&#39;\x14mwJ\x90[\x8ar:\xe1\xccY\xbc\xb5\x8b\xa1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>with</span> <span class=nx>open</span><span class=p>(</span><span class=s2>&#34;canvas.png&#34;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=nx>as</span> <span class=nx>f</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=nx>d</span> <span class=o>=</span> <span class=nx>f</span><span class=p>.</span><span class=nx>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>d</span> <span class=o>=</span> <span class=nx>algo</span><span class=p>.</span><span class=nx>decrypt</span><span class=p>(</span><span class=nx>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>with</span> <span class=nx>open</span><span class=p>(</span><span class=s2>&#34;dec-&#34;</span> <span class=o>+</span> <span class=s2>&#34;target.pdf&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span> <span class=nx>as</span> <span class=nx>f</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=nx>f</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=nx>d</span><span class=p>)</span>
</span></span></code></pre></div><p>Fun ride! Ever heard of <a href=https://github.com/angea/corkami/blob/master/src/angecryption/slides/AngeCryption.pdf target=_blank>AngeCryption</a>? üôÉ</p><p><a target=_blank rel="noopener noreferrer" href=/images/magic/13.png><img class=img src=/images/magic/13.png alt=Untitled></a></p><p><code>SHCTF{Ange_Crypts_And_Elf_source_Tricks}</code></p><h2 id=appendix>Appendix</h2><h3 id=deconstructed-bytecode><strong>Deconstructed Bytecode</strong></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=mi>1</span>           <span class=mi>0</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>2</span> <span class=nx>LOAD_CONST</span>               <span class=mi>1</span> <span class=p>((</span><span class=s1>&#39;AES&#39;</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>              <span class=mi>4</span> <span class=nx>IMPORT_NAME</span>              <span class=mi>0</span> <span class=p>(</span><span class=nx>Cryptodome</span><span class=p>.</span><span class=nx>Cipher</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>6</span> <span class=nx>IMPORT_FROM</span>              <span class=mi>1</span> <span class=p>(</span><span class=nx>AES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>8</span> <span class=nx>STORE_NAME</span>               <span class=mi>1</span> <span class=p>(</span><span class=nx>AES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>10</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>          <span class=mi>12</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>14</span> <span class=nx>LOAD_CONST</span>               <span class=mi>2</span> <span class=p>((</span><span class=s1>&#39;pad&#39;</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>             <span class=mi>16</span> <span class=nx>IMPORT_NAME</span>              <span class=mi>2</span> <span class=p>(</span><span class=nx>Cryptodome</span><span class=p>.</span><span class=nx>Util</span><span class=p>.</span><span class=nx>Padding</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>18</span> <span class=nx>IMPORT_FROM</span>              <span class=mi>3</span> <span class=p>(</span><span class=nx>pad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>20</span> <span class=nx>STORE_NAME</span>               <span class=mi>3</span> <span class=p>(</span><span class=nx>pad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>22</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>          <span class=mi>24</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>26</span> <span class=nx>LOAD_CONST</span>               <span class=mi>3</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>28</span> <span class=nx>IMPORT_NAME</span>              <span class=mi>4</span> <span class=p>(</span><span class=nx>struct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>30</span> <span class=nx>STORE_NAME</span>               <span class=mi>4</span> <span class=p>(</span><span class=nx>struct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=mi>4</span>          <span class=mi>32</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>34</span> <span class=nx>LOAD_CONST</span>               <span class=mi>4</span> <span class=p>((</span><span class=s1>&#39;crc32&#39;</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>             <span class=mi>36</span> <span class=nx>IMPORT_NAME</span>              <span class=mi>5</span> <span class=p>(</span><span class=nx>binascii</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>38</span> <span class=nx>IMPORT_FROM</span>              <span class=mi>6</span> <span class=p>(</span><span class=nx>crc32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>40</span> <span class=nx>STORE_NAME</span>               <span class=mi>6</span> <span class=p>(</span><span class=nx>crc32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>42</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=mi>6</span>          <span class=mi>44</span> <span class=nx>LOAD_CONST</span>               <span class=mi>5</span> <span class=p>(</span><span class=nx>b</span><span class=s1>&#39;\x89PNG\r\n\x1a\n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>46</span> <span class=nx>STORE_NAME</span>               <span class=mi>7</span> <span class=p>(</span><span class=nx>PNG_SIGNATURE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=mi>7</span>          <span class=mi>48</span> <span class=nx>LOAD_CONST</span>               <span class=mi>6</span> <span class=p>(</span><span class=nx>b</span><span class=s1>&#39;aaaa&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>50</span> <span class=nx>STORE_NAME</span>               <span class=mi>8</span> <span class=p>(</span><span class=nx>PNG_CHUNK_TYPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=mi>8</span>          <span class=mi>52</span> <span class=nx>LOAD_CONST</span>               <span class=mi>7</span> <span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>54</span> <span class=nx>STORE_NAME</span>               <span class=mi>9</span> <span class=p>(</span><span class=nx>BLOCK_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=mi>9</span>          <span class=mi>56</span> <span class=nx>LOAD_CONST</span>               <span class=mi>8</span> <span class=p>(</span><span class=nx>b</span><span class=s1>&#39;%PDF-1.4\n%\xd3\xeb\xe9\xe1\n1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>58</span> <span class=nx>STORE_NAME</span>              <span class=mi>10</span> <span class=p>(</span><span class=nx>PDF_PREFIX_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>11</span>          <span class=mi>60</span> <span class=nx>LOAD_CONST</span>               <span class=mi>9</span> <span class=p>(</span><span class=s1>&#39;return&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>62</span> <span class=nx>LOAD_NAME</span>               <span class=mi>11</span> <span class=p>(</span><span class=nx>bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>64</span> <span class=nx>BUILD_TUPLE</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>             <span class=mi>66</span> <span class=nx>LOAD_CONST</span>              <span class=mi>10</span> <span class=p>(&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=na>derive_key</span> <span class=na>at</span> <span class=na>0x7f9ef68fb310</span><span class=err>,</span> <span class=na>file</span> <span class=err>&#34;</span><span class=na>magic.py</span><span class=err>&#34;,</span> <span class=na>line</span> <span class=na>11</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl>             <span class=mi>68</span> <span class=nx>LOAD_CONST</span>              <span class=mi>11</span> <span class=p>(</span><span class=s1>&#39;derive_key&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>70</span> <span class=nx>MAKE_FUNCTION</span>            <span class=mi>4</span> <span class=p>(</span><span class=nx>annotations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>72</span> <span class=nx>STORE_NAME</span>              <span class=mi>12</span> <span class=p>(</span><span class=nx>derive_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>16</span>          <span class=mi>74</span> <span class=nx>LOAD_CONST</span>              <span class=mi>12</span> <span class=p>(</span><span class=s1>&#39;file_path&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>76</span> <span class=nx>LOAD_NAME</span>               <span class=mi>13</span> <span class=p>(</span><span class=nx>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>78</span> <span class=nx>LOAD_CONST</span>               <span class=mi>9</span> <span class=p>(</span><span class=s1>&#39;return&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>80</span> <span class=nx>LOAD_NAME</span>               <span class=mi>11</span> <span class=p>(</span><span class=nx>bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>82</span> <span class=nx>BUILD_TUPLE</span>              <span class=mi>4</span>
</span></span><span class=line><span class=cl>             <span class=mi>84</span> <span class=nx>LOAD_CONST</span>              <span class=mi>13</span> <span class=p>(&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=na>read_file_content</span> <span class=na>at</span> <span class=na>0x7f9ef68fb520</span><span class=err>,</span> <span class=na>file</span> <span class=err>&#34;</span><span class=na>magic.py</span><span class=err>&#34;,</span> <span class=na>line</span> <span class=na>16</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl>             <span class=mi>86</span> <span class=nx>LOAD_CONST</span>              <span class=mi>14</span> <span class=p>(</span><span class=s1>&#39;read_file_content&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>88</span> <span class=nx>MAKE_FUNCTION</span>            <span class=mi>4</span> <span class=p>(</span><span class=nx>annotations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>90</span> <span class=nx>STORE_NAME</span>              <span class=mi>14</span> <span class=p>(</span><span class=nx>read_file_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>21</span>          <span class=mi>92</span> <span class=nx>LOAD_CONST</span>              <span class=mi>15</span> <span class=p>(</span><span class=s1>&#39;pdf_path&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>94</span> <span class=nx>LOAD_NAME</span>               <span class=mi>13</span> <span class=p>(</span><span class=nx>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>96</span> <span class=nx>LOAD_CONST</span>              <span class=mi>16</span> <span class=p>(</span><span class=s1>&#39;png_path&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>98</span> <span class=nx>LOAD_NAME</span>               <span class=mi>13</span> <span class=p>(</span><span class=nx>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>100</span> <span class=nx>BUILD_TUPLE</span>              <span class=mi>4</span>
</span></span><span class=line><span class=cl>            <span class=mi>102</span> <span class=nx>LOAD_CONST</span>              <span class=mi>17</span> <span class=p>(&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=na>embed_and_extract</span> <span class=na>at</span> <span class=na>0x7f9ef68fb680</span><span class=err>,</span> <span class=na>file</span> <span class=err>&#34;</span><span class=na>magic.py</span><span class=err>&#34;,</span> <span class=na>line</span> <span class=na>21</span><span class=p>&gt;)</span>
</span></span><span class=line><span class=cl>            <span class=mi>104</span> <span class=nx>LOAD_CONST</span>              <span class=mi>18</span> <span class=p>(</span><span class=s1>&#39;embed_and_extract&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>106</span> <span class=nx>MAKE_FUNCTION</span>            <span class=mi>4</span> <span class=p>(</span><span class=nx>annotations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>108</span> <span class=nx>STORE_NAME</span>              <span class=mi>15</span> <span class=p>(</span><span class=nx>embed_and_extract</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>45</span>         <span class=mi>110</span> <span class=nx>LOAD_NAME</span>               <span class=mi>15</span> <span class=p>(</span><span class=nx>embed_and_extract</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>112</span> <span class=nx>LOAD_CONST</span>              <span class=mi>19</span> <span class=p>(</span><span class=s1>&#39;source.pdf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>114</span> <span class=nx>LOAD_CONST</span>              <span class=mi>20</span> <span class=p>(</span><span class=s1>&#39;target.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>116</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=mi>118</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>120</span> <span class=nx>LOAD_CONST</span>               <span class=mi>3</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>122</span> <span class=nx>RETURN_VALUE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Disassembly</span> <span class=k>of</span> <span class=p>&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=na>derive_key</span> <span class=na>at</span> <span class=na>0x7f9ef68fb310</span><span class=err>,</span> <span class=na>file</span> <span class=err>&#34;</span><span class=na>magic.py</span><span class=err>&#34;,</span> <span class=na>line</span> <span class=na>11</span><span class=p>&gt;</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=mi>13</span>           <span class=mi>0</span> <span class=nx>LOAD_CONST</span>               <span class=mi>1</span> <span class=p>(</span><span class=s1>&#39;[rh&lt;c8^ey?}ng:el&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>2</span> <span class=nx>STORE_FAST</span>               <span class=mi>0</span> <span class=p>(</span><span class=nx>xored_string</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>14</span>           <span class=mi>4</span> <span class=nx>LOAD_CONST</span>               <span class=mi>2</span> <span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>6</span> <span class=nx>LOAD_METHOD</span>              <span class=mi>0</span> <span class=p>(</span><span class=nx>join</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>8</span> <span class=nx>LOAD_CONST</span>               <span class=mi>3</span> <span class=p>(&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=err>&lt;</span><span class=na>genexpr</span><span class=p>&gt;</span> <span class=nx>at</span> <span class=mh>0x7f9ef68face0</span><span class=p>,</span> <span class=nx>file</span> <span class=s2>&#34;magic.py&#34;</span><span class=p>,</span> <span class=nx>line</span> <span class=mi>14</span><span class=o>&gt;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>10</span> <span class=nx>LOAD_CONST</span>               <span class=mi>4</span> <span class=p>(</span><span class=s1>&#39;derive_key.&lt;locals&gt;.&lt;genexpr&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>12</span> <span class=nx>MAKE_FUNCTION</span>            <span class=mi>0</span>
</span></span><span class=line><span class=cl>             <span class=mi>14</span> <span class=nx>LOAD_FAST</span>                <span class=mi>0</span> <span class=p>(</span><span class=nx>xored_string</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>16</span> <span class=nx>GET_ITER</span>
</span></span><span class=line><span class=cl>             <span class=mi>18</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>             <span class=mi>20</span> <span class=nx>CALL_METHOD</span>              <span class=mi>1</span>
</span></span><span class=line><span class=cl>             <span class=mi>22</span> <span class=nx>LOAD_METHOD</span>              <span class=mi>1</span> <span class=p>(</span><span class=nx>encode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>24</span> <span class=nx>CALL_METHOD</span>              <span class=mi>0</span>
</span></span><span class=line><span class=cl>             <span class=mi>26</span> <span class=nx>RETURN_VALUE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Disassembly</span> <span class=k>of</span> <span class=p>&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=err>&lt;</span><span class=na>genexpr</span><span class=p>&gt;</span> <span class=nx>at</span> <span class=mh>0x7f9ef68face0</span><span class=p>,</span> <span class=nx>file</span> <span class=s2>&#34;magic.py&#34;</span><span class=p>,</span> <span class=nx>line</span> <span class=mi>14</span><span class=o>&gt;:</span>
</span></span><span class=line><span class=cl>              <span class=mi>0</span> <span class=nx>GEN_START</span>                <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>14</span>           <span class=mi>2</span> <span class=nx>LOAD_FAST</span>                <span class=mi>0</span> <span class=p>(</span><span class=mf>.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;&gt;</span>    <span class=mi>4</span> <span class=nx>FOR_ITER</span>                <span class=mi>11</span> <span class=p>(</span><span class=nx>to</span> <span class=mi>28</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>6</span> <span class=nx>STORE_FAST</span>               <span class=mi>1</span> <span class=p>(</span><span class=kr>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>8</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>0</span> <span class=p>(</span><span class=nx>chr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>10</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>1</span> <span class=p>(</span><span class=nx>ord</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>12</span> <span class=nx>LOAD_FAST</span>                <span class=mi>1</span> <span class=p>(</span><span class=kr>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>14</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>             <span class=mi>16</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=mi>11</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>18</span> <span class=nx>BINARY_XOR</span>
</span></span><span class=line><span class=cl>             <span class=mi>20</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>             <span class=mi>22</span> <span class=nx>YIELD_VALUE</span>
</span></span><span class=line><span class=cl>             <span class=mi>24</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>             <span class=mi>26</span> <span class=nx>JUMP_ABSOLUTE</span>            <span class=mi>2</span> <span class=p>(</span><span class=nx>to</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;&gt;</span>   <span class=mi>28</span> <span class=nx>LOAD_CONST</span>               <span class=mi>1</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>30</span> <span class=nx>RETURN_VALUE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Disassembly</span> <span class=k>of</span> <span class=p>&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=na>read_file_content</span> <span class=na>at</span> <span class=na>0x7f9ef68fb520</span><span class=err>,</span> <span class=na>file</span> <span class=err>&#34;</span><span class=na>magic.py</span><span class=err>&#34;,</span> <span class=na>line</span> <span class=na>16</span><span class=p>&gt;</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=mi>18</span>           <span class=mi>0</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>0</span> <span class=p>(</span><span class=nx>open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>2</span> <span class=nx>LOAD_FAST</span>                <span class=mi>0</span> <span class=p>(</span><span class=nx>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>4</span> <span class=nx>LOAD_CONST</span>               <span class=mi>1</span> <span class=p>(</span><span class=s1>&#39;rb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>6</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>2</span>
</span></span><span class=line><span class=cl>              <span class=mi>8</span> <span class=nx>SETUP_WITH</span>              <span class=mi>15</span> <span class=p>(</span><span class=nx>to</span> <span class=mi>40</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>10</span> <span class=nx>STORE_FAST</span>               <span class=mi>1</span> <span class=p>(</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>19</span>          <span class=mi>12</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>1</span> <span class=p>(</span><span class=nx>pad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>14</span> <span class=nx>LOAD_FAST</span>                <span class=mi>1</span> <span class=p>(</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>16</span> <span class=nx>LOAD_METHOD</span>              <span class=mi>2</span> <span class=p>(</span><span class=nx>read</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>18</span> <span class=nx>CALL_METHOD</span>              <span class=mi>0</span>
</span></span><span class=line><span class=cl>             <span class=mi>20</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>3</span> <span class=p>(</span><span class=nx>BLOCK_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>22</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>18</span>          <span class=mi>24</span> <span class=nx>POP_BLOCK</span>
</span></span><span class=line><span class=cl>             <span class=mi>26</span> <span class=nx>ROT_TWO</span>
</span></span><span class=line><span class=cl>             <span class=mi>28</span> <span class=nx>LOAD_CONST</span>               <span class=mi>2</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>30</span> <span class=nx>DUP_TOP</span>
</span></span><span class=line><span class=cl>             <span class=mi>32</span> <span class=nx>DUP_TOP</span>
</span></span><span class=line><span class=cl>             <span class=mi>34</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>3</span>
</span></span><span class=line><span class=cl>             <span class=mi>36</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>             <span class=mi>38</span> <span class=nx>RETURN_VALUE</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;&gt;</span>   <span class=mi>40</span> <span class=nx>WITH_EXCEPT_START</span>
</span></span><span class=line><span class=cl>             <span class=mi>42</span> <span class=nx>POP_JUMP_IF_TRUE</span>        <span class=mi>23</span> <span class=p>(</span><span class=nx>to</span> <span class=mi>46</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>44</span> <span class=nx>RERAISE</span>                  <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;&gt;</span>   <span class=mi>46</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>             <span class=mi>48</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>             <span class=mi>50</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>             <span class=mi>52</span> <span class=nx>POP_EXCEPT</span>
</span></span><span class=line><span class=cl>             <span class=mi>54</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>             <span class=mi>56</span> <span class=nx>LOAD_CONST</span>               <span class=mi>2</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>58</span> <span class=nx>RETURN_VALUE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Disassembly</span> <span class=k>of</span> <span class=p>&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=na>embed_and_extract</span> <span class=na>at</span> <span class=na>0x7f9ef68fb680</span><span class=err>,</span> <span class=na>file</span> <span class=err>&#34;</span><span class=na>magic.py</span><span class=err>&#34;,</span> <span class=na>line</span> <span class=na>21</span><span class=p>&gt;</span><span class=o>:</span>
</span></span><span class=line><span class=cl> <span class=mi>22</span>           <span class=mi>0</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>0</span> <span class=p>(</span><span class=nx>derive_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>2</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>0</span>
</span></span><span class=line><span class=cl>              <span class=mi>4</span> <span class=nx>STORE_FAST</span>               <span class=mi>2</span> <span class=p>(</span><span class=nx>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>24</span>           <span class=mi>6</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>1</span> <span class=p>(</span><span class=nx>read_file_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>8</span> <span class=nx>LOAD_FAST</span>                <span class=mi>0</span> <span class=p>(</span><span class=nx>pdf_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>10</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>             <span class=mi>12</span> <span class=nx>STORE_FAST</span>               <span class=mi>3</span> <span class=p>(</span><span class=nx>pdf_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>25</span>          <span class=mi>14</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>1</span> <span class=p>(</span><span class=nx>read_file_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>16</span> <span class=nx>LOAD_FAST</span>                <span class=mi>1</span> <span class=p>(</span><span class=nx>png_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>18</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>             <span class=mi>20</span> <span class=nx>STORE_FAST</span>               <span class=mi>4</span> <span class=p>(</span><span class=nx>png_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>28</span>          <span class=mi>22</span> <span class=nx>LOAD_FAST</span>                <span class=mi>3</span> <span class=p>(</span><span class=nx>pdf_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>24</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>26</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>2</span> <span class=p>(</span><span class=nx>BLOCK_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>28</span> <span class=nx>BUILD_SLICE</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>             <span class=mi>30</span> <span class=nx>BINARY_SUBSCR</span>
</span></span><span class=line><span class=cl>             <span class=mi>32</span> <span class=nx>STORE_DEREF</span>              <span class=mi>1</span> <span class=p>(</span><span class=nx>plain_pdf_prefix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>29</span>          <span class=mi>34</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>3</span> <span class=p>(</span><span class=nx>PNG_SIGNATURE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>36</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>4</span> <span class=p>(</span><span class=nx>struct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>38</span> <span class=nx>LOAD_METHOD</span>              <span class=mi>5</span> <span class=p>(</span><span class=nx>pack</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>40</span> <span class=nx>LOAD_CONST</span>               <span class=mi>1</span> <span class=p>(</span><span class=s1>&#39;&gt;I&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>42</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>6</span> <span class=p>(</span><span class=nx>len</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>44</span> <span class=nx>LOAD_FAST</span>                <span class=mi>3</span> <span class=p>(</span><span class=nx>pdf_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>46</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>             <span class=mi>48</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>2</span> <span class=p>(</span><span class=nx>BLOCK_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>50</span> <span class=nx>BINARY_SUBTRACT</span>
</span></span><span class=line><span class=cl>             <span class=mi>52</span> <span class=nx>CALL_METHOD</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>             <span class=mi>54</span> <span class=nx>BINARY_ADD</span>
</span></span><span class=line><span class=cl>             <span class=mi>56</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>7</span> <span class=p>(</span><span class=nx>PNG_CHUNK_TYPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>58</span> <span class=nx>BINARY_ADD</span>
</span></span><span class=line><span class=cl>             <span class=mi>60</span> <span class=nx>STORE_FAST</span>               <span class=mi>5</span> <span class=p>(</span><span class=nx>png_header</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>30</span>          <span class=mi>62</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>8</span> <span class=p>(</span><span class=nx>AES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>64</span> <span class=nx>LOAD_METHOD</span>              <span class=mi>9</span> <span class=p>(</span><span class=k>new</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>66</span> <span class=nx>LOAD_FAST</span>                <span class=mi>2</span> <span class=p>(</span><span class=nx>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>68</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>8</span> <span class=p>(</span><span class=nx>AES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>70</span> <span class=nx>LOAD_ATTR</span>               <span class=mi>10</span> <span class=p>(</span><span class=nx>MODE_ECB</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>72</span> <span class=nx>CALL_METHOD</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>             <span class=mi>74</span> <span class=nx>LOAD_METHOD</span>             <span class=mi>11</span> <span class=p>(</span><span class=nx>decrypt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>76</span> <span class=nx>LOAD_FAST</span>                <span class=mi>5</span> <span class=p>(</span><span class=nx>png_header</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>78</span> <span class=nx>CALL_METHOD</span>              <span class=mi>1</span>
</span></span><span class=line><span class=cl>             <span class=mi>80</span> <span class=nx>STORE_DEREF</span>              <span class=mi>0</span> <span class=p>(</span><span class=nx>decrypted_header</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>31</span>          <span class=mi>82</span> <span class=nx>LOAD_GLOBAL</span>             <span class=mi>12</span> <span class=p>(</span><span class=nx>bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>84</span> <span class=nx>LOAD_CLOSURE</span>             <span class=mi>0</span> <span class=p>(</span><span class=nx>decrypted_header</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>86</span> <span class=nx>LOAD_CLOSURE</span>             <span class=mi>1</span> <span class=p>(</span><span class=nx>plain_pdf_prefix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>88</span> <span class=nx>BUILD_TUPLE</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>             <span class=mi>90</span> <span class=nx>LOAD_CONST</span>               <span class=mi>2</span> <span class=p>(&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=err>&lt;</span><span class=na>listcomp</span><span class=p>&gt;</span> <span class=nx>at</span> <span class=mh>0x7f9ef68fb5d0</span><span class=p>,</span> <span class=nx>file</span> <span class=s2>&#34;magic.py&#34;</span><span class=p>,</span> <span class=nx>line</span> <span class=mi>31</span><span class=o>&gt;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>92</span> <span class=nx>LOAD_CONST</span>               <span class=mi>3</span> <span class=p>(</span><span class=s1>&#39;embed_and_extract.&lt;locals&gt;.&lt;listcomp&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>94</span> <span class=nx>MAKE_FUNCTION</span>            <span class=mi>8</span> <span class=p>(</span><span class=nx>closure</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>96</span> <span class=nx>LOAD_GLOBAL</span>             <span class=mi>13</span> <span class=p>(</span><span class=nx>range</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>98</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>2</span> <span class=p>(</span><span class=nx>BLOCK_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>100</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=mi>102</span> <span class=nx>GET_ITER</span>
</span></span><span class=line><span class=cl>            <span class=mi>104</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=mi>106</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=mi>108</span> <span class=nx>STORE_FAST</span>               <span class=mi>6</span> <span class=p>(</span><span class=nx>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>32</span>         <span class=mi>110</span> <span class=nx>LOAD_GLOBAL</span>             <span class=mi>14</span> <span class=p>(</span><span class=nx>print</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>112</span> <span class=nx>LOAD_FAST</span>                <span class=mi>6</span> <span class=p>(</span><span class=nx>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>114</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=mi>116</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>35</span>         <span class=mi>118</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>8</span> <span class=p>(</span><span class=nx>AES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>120</span> <span class=nx>LOAD_METHOD</span>              <span class=mi>9</span> <span class=p>(</span><span class=k>new</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>122</span> <span class=nx>LOAD_FAST</span>                <span class=mi>2</span> <span class=p>(</span><span class=nx>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>124</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>8</span> <span class=p>(</span><span class=nx>AES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>126</span> <span class=nx>LOAD_ATTR</span>               <span class=mi>15</span> <span class=p>(</span><span class=nx>MODE_CBC</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>128</span> <span class=nx>LOAD_FAST</span>                <span class=mi>6</span> <span class=p>(</span><span class=nx>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>130</span> <span class=nx>CALL_METHOD</span>              <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=mi>132</span> <span class=nx>STORE_FAST</span>               <span class=mi>7</span> <span class=p>(</span><span class=nx>aes_encryption</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>36</span>         <span class=mi>134</span> <span class=nx>LOAD_FAST</span>                <span class=mi>7</span> <span class=p>(</span><span class=nx>aes_encryption</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>136</span> <span class=nx>LOAD_METHOD</span>             <span class=mi>16</span> <span class=p>(</span><span class=nx>encrypt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>138</span> <span class=nx>LOAD_FAST</span>                <span class=mi>3</span> <span class=p>(</span><span class=nx>pdf_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>140</span> <span class=nx>CALL_METHOD</span>              <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=mi>142</span> <span class=nx>STORE_FAST</span>               <span class=mi>8</span> <span class=p>(</span><span class=nx>encrypted_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>37</span>         <span class=mi>144</span> <span class=nx>LOAD_FAST</span>                <span class=mi>8</span> <span class=p>(</span><span class=nx>encrypted_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>146</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>4</span> <span class=p>(</span><span class=nx>struct</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>148</span> <span class=nx>LOAD_METHOD</span>              <span class=mi>5</span> <span class=p>(</span><span class=nx>pack</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>150</span> <span class=nx>LOAD_CONST</span>               <span class=mi>1</span> <span class=p>(</span><span class=s1>&#39;&gt;I&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>152</span> <span class=nx>LOAD_GLOBAL</span>             <span class=mi>17</span> <span class=p>(</span><span class=nx>crc32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>154</span> <span class=nx>LOAD_FAST</span>                <span class=mi>8</span> <span class=p>(</span><span class=nx>encrypted_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>156</span> <span class=nx>LOAD_CONST</span>               <span class=mi>4</span> <span class=p>(</span><span class=mi>12</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>158</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>160</span> <span class=nx>BUILD_SLICE</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=mi>162</span> <span class=nx>BINARY_SUBSCR</span>
</span></span><span class=line><span class=cl>            <span class=mi>164</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=mi>166</span> <span class=nx>LOAD_CONST</span>               <span class=mi>5</span> <span class=p>(</span><span class=mi>4294967295</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>168</span> <span class=nx>BINARY_AND</span>
</span></span><span class=line><span class=cl>            <span class=mi>170</span> <span class=nx>CALL_METHOD</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=mi>172</span> <span class=nx>INPLACE_ADD</span>
</span></span><span class=line><span class=cl>            <span class=mi>174</span> <span class=nx>STORE_FAST</span>               <span class=mi>8</span> <span class=p>(</span><span class=nx>encrypted_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>38</span>         <span class=mi>176</span> <span class=nx>LOAD_FAST</span>                <span class=mi>8</span> <span class=p>(</span><span class=nx>encrypted_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>178</span> <span class=nx>LOAD_FAST</span>                <span class=mi>4</span> <span class=p>(</span><span class=nx>png_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>180</span> <span class=nx>LOAD_CONST</span>               <span class=mi>6</span> <span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>182</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>184</span> <span class=nx>BUILD_SLICE</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=mi>186</span> <span class=nx>BINARY_SUBSCR</span>
</span></span><span class=line><span class=cl>            <span class=mi>188</span> <span class=nx>INPLACE_ADD</span>
</span></span><span class=line><span class=cl>            <span class=mi>190</span> <span class=nx>STORE_FAST</span>               <span class=mi>8</span> <span class=p>(</span><span class=nx>encrypted_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>41</span>         <span class=mi>192</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>8</span> <span class=p>(</span><span class=nx>AES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>194</span> <span class=nx>LOAD_METHOD</span>              <span class=mi>9</span> <span class=p>(</span><span class=k>new</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>196</span> <span class=nx>LOAD_FAST</span>                <span class=mi>2</span> <span class=p>(</span><span class=nx>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>198</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>8</span> <span class=p>(</span><span class=nx>AES</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>200</span> <span class=nx>LOAD_ATTR</span>               <span class=mi>15</span> <span class=p>(</span><span class=nx>MODE_CBC</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>202</span> <span class=nx>LOAD_FAST</span>                <span class=mi>6</span> <span class=p>(</span><span class=nx>iv</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>204</span> <span class=nx>CALL_METHOD</span>              <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=mi>206</span> <span class=nx>STORE_FAST</span>               <span class=mi>9</span> <span class=p>(</span><span class=nx>aes_decryption</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>42</span>         <span class=mi>208</span> <span class=nx>LOAD_GLOBAL</span>             <span class=mi>18</span> <span class=p>(</span><span class=nx>open</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>210</span> <span class=nx>LOAD_CONST</span>               <span class=mi>7</span> <span class=p>(</span><span class=s1>&#39;out.pdf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>212</span> <span class=nx>LOAD_CONST</span>               <span class=mi>8</span> <span class=p>(</span><span class=s1>&#39;wb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>214</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=mi>216</span> <span class=nx>SETUP_WITH</span>              <span class=mi>20</span> <span class=p>(</span><span class=nx>to</span> <span class=mi>258</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>218</span> <span class=nx>STORE_FAST</span>              <span class=mi>10</span> <span class=p>(</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>43</span>         <span class=mi>220</span> <span class=nx>LOAD_FAST</span>               <span class=mi>10</span> <span class=p>(</span><span class=nx>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>222</span> <span class=nx>LOAD_METHOD</span>             <span class=mi>19</span> <span class=p>(</span><span class=nx>write</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>224</span> <span class=nx>LOAD_FAST</span>                <span class=mi>9</span> <span class=p>(</span><span class=nx>aes_decryption</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>226</span> <span class=nx>LOAD_METHOD</span>             <span class=mi>11</span> <span class=p>(</span><span class=nx>decrypt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>228</span> <span class=nx>LOAD_GLOBAL</span>             <span class=mi>20</span> <span class=p>(</span><span class=nx>pad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>230</span> <span class=nx>LOAD_FAST</span>                <span class=mi>8</span> <span class=p>(</span><span class=nx>encrypted_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>232</span> <span class=nx>LOAD_GLOBAL</span>              <span class=mi>2</span> <span class=p>(</span><span class=nx>BLOCK_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>234</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=mi>236</span> <span class=nx>CALL_METHOD</span>              <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=mi>238</span> <span class=nx>CALL_METHOD</span>              <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=mi>240</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>242</span> <span class=nx>POP_BLOCK</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=mi>42</span>         <span class=mi>244</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>246</span> <span class=nx>DUP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>248</span> <span class=nx>DUP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>250</span> <span class=nx>CALL_FUNCTION</span>            <span class=mi>3</span>
</span></span><span class=line><span class=cl>            <span class=mi>252</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>254</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>256</span> <span class=nx>RETURN_VALUE</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;&gt;</span>  <span class=mi>258</span> <span class=nx>WITH_EXCEPT_START</span>
</span></span><span class=line><span class=cl>            <span class=mi>260</span> <span class=nx>POP_JUMP_IF_TRUE</span>       <span class=mi>132</span> <span class=p>(</span><span class=nx>to</span> <span class=mi>264</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>262</span> <span class=nx>RERAISE</span>                  <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;&gt;</span>  <span class=mi>264</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>266</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>268</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>270</span> <span class=nx>POP_EXCEPT</span>
</span></span><span class=line><span class=cl>            <span class=mi>272</span> <span class=nx>POP_TOP</span>
</span></span><span class=line><span class=cl>            <span class=mi>274</span> <span class=nx>LOAD_CONST</span>               <span class=mi>0</span> <span class=p>(</span><span class=nx>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=mi>276</span> <span class=nx>RETURN_VALUE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Disassembly</span> <span class=k>of</span> <span class=p>&lt;</span><span class=nt>code</span> <span class=na>object</span> <span class=err>&lt;</span><span class=na>listcomp</span><span class=p>&gt;</span> <span class=nx>at</span> <span class=mh>0x7f9ef68fb5d0</span><span class=p>,</span> <span class=nx>file</span> <span class=s2>&#34;magic.py&#34;</span><span class=p>,</span> <span class=nx>line</span> <span class=mi>31</span><span class=o>&gt;:</span>
</span></span><span class=line><span class=cl> <span class=mi>31</span>           <span class=mi>0</span> <span class=nx>BUILD_LIST</span>               <span class=mi>0</span>
</span></span><span class=line><span class=cl>              <span class=mi>2</span> <span class=nx>LOAD_FAST</span>                <span class=mi>0</span> <span class=p>(</span><span class=mf>.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;&gt;</span>    <span class=mi>4</span> <span class=nx>FOR_ITER</span>                <span class=mi>10</span> <span class=p>(</span><span class=nx>to</span> <span class=mi>26</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>6</span> <span class=nx>STORE_FAST</span>               <span class=mi>1</span> <span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=mi>8</span> <span class=nx>LOAD_DEREF</span>               <span class=mi>0</span> <span class=p>(</span><span class=nx>decrypted_header</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>10</span> <span class=nx>LOAD_FAST</span>                <span class=mi>1</span> <span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>12</span> <span class=nx>BINARY_SUBSCR</span>
</span></span><span class=line><span class=cl>             <span class=mi>14</span> <span class=nx>LOAD_DEREF</span>               <span class=mi>1</span> <span class=p>(</span><span class=nx>plain_pdf_prefix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>16</span> <span class=nx>LOAD_FAST</span>                <span class=mi>1</span> <span class=p>(</span><span class=nx>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=mi>18</span> <span class=nx>BINARY_SUBSCR</span>
</span></span><span class=line><span class=cl>             <span class=mi>20</span> <span class=nx>BINARY_XOR</span>
</span></span><span class=line><span class=cl>             <span class=mi>22</span> <span class=nx>LIST_APPEND</span>              <span class=mi>2</span>
</span></span><span class=line><span class=cl>             <span class=mi>24</span> <span class=nx>JUMP_ABSOLUTE</span>            <span class=mi>2</span> <span class=p>(</span><span class=nx>to</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;&gt;</span>   <span class=mi>26</span> <span class=nx>RETURN_VALUE</span>
</span></span></code></pre></div></article><section class=article-labels><a class="article-category li" href=/categories/ctf-writeups/><span class=hashtag>#</span>CTF WriteUps</a><a class="article-category li" href=/categories/reverse-engineering/><span class=hashtag>#</span>Reverse Engineering</a><a class="article-tag li" href=/tags/shctf/><span class=hashtag>#</span>shctf</a><a class="article-tag li" href=/tags/angecryption/><span class=hashtag>#</span>angecryption</a></section><section class=article-navigation><p><a class=link href=/posts/snotes/><span class=li></span>SHCTF23: SecureNotes3</a class="link"></p></section><section class=article-discussion><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//the-mess-of-nebula.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div><section id=footer class="footer max-body-width"><p>¬© 2023 Eva Levanto</p><p><span>Powered by </span><a href=https://gohugo.io>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/>Notepadium</a></p></section><script defer type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity=sha384-e/4/LvThKH1gwzXhdbY2AsjR3rm7LHWyhIG5C0jiRfn8AN2eTN5ILeztWw0H9jmN crossorigin=anonymous>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"}),MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}})</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","your-google-analytics-id","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>