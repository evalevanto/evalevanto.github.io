<!doctype html><html><meta charset=utf-8><meta name=generator content="Hugo 0.114.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>GDAL on Travis&nbsp;&ndash;&nbsp;The Mess Of Nebula</title><link rel=stylesheet href=/css/core.min.3dff9636f60da21a7bce297e09d08d8f636d1b8e7def5079c790207b0c0dfdc945858b105a0c7fc6c4a0b4f9ae05e8d3.css integrity=sha384-Pf+WNvYNohp7zil+CdCNj2NtG45971B5x5AgewwN/clFhYsQWgx/xsSgtPmuBejT><body><div class="base-body max-width"><section id=header class="header max-body-width"><div class=header-wrap><div class=header-left-side><a class=home href=/><span class=site-name>The Mess Of Nebula</span><span class=site-slogan>Gravitations towards point origin</span></a></div><div class=header-right-side><div class=nav-wrap><div class=nav><a class=site-tag href=/categories/>Categories</a><a class=site-tag href=/tags/>Tags</a><a class=site-tag href=/about>About</a></div></div></div></div></section><div id=content class="flex-body max-body-width"><section class=article-header><h1>GDAL on Travis</h1><p class=article-date>2020-03-25</p></section><article class=markdown-body><p><a target=_blank rel="noopener noreferrer" href=images/map.jpeg><img class=img src=images/map.jpeg alt></a></p><p>Frustrations around finding helpful articles have led to this writing. The steps follow an error reproduction to a solid solution for the issue.</p><p>The GDAL version installed on the chosen machine must match the package library version installed into your project. Example, <code>glad-config -v == pip freeze | grep GDAL</code>.</p><p>The project runs python3.7 and requires a GDAL version == 2.4.2, though > 2.2.0 would not break it.</p><p>At the time of this writing, travis supports the following distros:</p><blockquote></blockquote><ul><li>precise - Ubuntu 12.04</li><li>trusty - Ubuntu 14.04</li><li>xenial - Ubuntu 16.04</li><li>bionic - Ubuntu 18.04</li></ul><p>Xenial is set as the default distro.</p><p>In the first configuration, xenial distribution is used. Ubuntu 16.04. The package <code>libgdal-dev</code> in <code>xenial</code> is <code>1.11.3+dfsg-3build2</code>. See this <a href="https://packages.ubuntu.com/search?keywords=libgdal-dev" target=_blank>package list</a>.</p><p>To get the latest releases for Ubuntu GIS packages, the source from <a href=https://launchpad.net/~ubuntugis/+archive/ubuntu/ubuntugis-unstable target=_blank>ubuntugis</a>: <code>ubuntugis/ubuntugis-unstable</code> attempts is added. Now later versions can be pulled and installed.</p><p><a target=_blank rel="noopener noreferrer" href=/images/first_config.png><img class=img src=/images/first_config.png alt></a></p><p>However, this build fails, the source is not whitelisted:</p><p><a target=_blank rel="noopener noreferrer" href=/images/first_build.png><img class=img src=/images/first_build.png alt></a></p><p>There exists an open <a href=https://github.com/travis-ci/apt-source-safelist/issues/38 target=_blank>issue</a> on the travis-ci repo on this.</p><p>The second configuration, bionic distribution is used instead. The package <code>libgdal-dev</code> in <code>bionic</code> is <code>2.2.3+dfsg-2</code>.</p><p><a target=_blank rel="noopener noreferrer" href=/images/second_config.png><img class=img src=/images/second_config.png alt></a></p><p>An error is noticed in the build.</p><p><a target=_blank rel="noopener noreferrer" href=/images/second_build.png><img class=img src=/images/second_build.png alt></a></p><p>The build defaults to Ubuntu xenial. Looking through possible solutions on <a href=https://travis-ci.community/t/ubuntu-18-04-1-lts-bionic-beaver/1270/21 target=_blank>forums</a>, downing the python version to <code>3.6</code> still produces the same issue.</p><blockquote><p>There are successful <a href=https://travis-ci.org/github/LolexUK/Lolex-Tools/jobs/446612398/ target=_blank>builds</a> running on bionic.<br>If you can run on bionic and this fills your requirements.. You can <code>exit()</code> :)</p><p>This however remains an issue in this build at the time of writing this. If you have a workaround, solution,, feel free to comment links to the same.</p></blockquote><h5 id=workaround>Workaround</h5><p>The next resolve is to download the source from OSGEO and build the specific GDAL version.</p><p><a target=_blank rel="noopener noreferrer" href=/images/travis_script.png><img class=img src=/images/travis_script.png alt></a></p><p>GDAL is dependent on proj which also is installed and built.</p><p><a target=_blank rel="noopener noreferrer" href=/images/proj_script.png><img class=img src=/images/proj_script.png alt></a></p><p>Credit to these modified scripts go to <a href=https://github.com/Toblerity/Fiona/blob/master/scripts/travis_gdal_install.sh target=_blank>@rbuffat to Toblerity/Fiona</a>.. who contributed the original script.</p><p>This takes a while, but guarantees the specific version is built on the machine.</p><p>The travis configuration for this:</p><p><a target=_blank rel="noopener noreferrer" href=/images/final_config.png><img class=img src=/images/final_config.png alt></a></p><p>To save on the make install time during every build, the <em>GDAL installations</em> are cached.</p><p><a target=_blank rel="noopener noreferrer" href=/images/cache.png><img class=img src=/images/cache.png alt></a></p><blockquote><p>In retrospect, this approach is much better to use. It gives you control over the specific versions of GDAL you want to use while maintaining whatever distro you have. Also, you can matrix(like in the original script) and have different versions for different cases.</p></blockquote><p><a target=_blank rel="noopener noreferrer" href=/images/travis.png><img class=img src=/images/travis.png alt></a></p></article><section class=article-labels><a class="article-category li" href=/categories/ci/cd/><span class=hashtag>#</span>CI/CD</a><a class="article-category li" href=/categories/computer-vision/><span class=hashtag>#</span>Computer Vision</a><a class="article-tag li" href=/tags/travis/><span class=hashtag>#</span>travis</a><a class="article-tag li" href=/tags/gdal/><span class=hashtag>#</span>gdal</a></section><section class=article-navigation><p><a class=link href=/posts/microcorruption-sydney/><span class=li></span>MicroCorruption: Sydney</a></p><p><a class=link href=/posts/commandparser/><span class=li></span>AH19CTF WriteUps: Command Parser</a class="link"></p></section><section class=article-discussion><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//the-mess-of-nebula.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div><section id=footer class="footer max-body-width"><p>Â© 2023 Eva Levanto</p><p><span>Powered by </span><a href=https://gohugo.io>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/>Notepadium</a></p></section><script defer type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity=sha384-e/4/LvThKH1gwzXhdbY2AsjR3rm7LHWyhIG5C0jiRfn8AN2eTN5ILeztWw0H9jmN crossorigin=anonymous>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"}),MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}})</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","your-google-analytics-id","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>